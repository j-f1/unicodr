<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Unicodr Settings</title>
    <link rel="stylesheet" href="vendor/min.css" charset="utf-8">
    <link rel="stylesheet" href="index.css" charset="utf-8">
    <script src="../node_modules/jquery/dist/jquery.js" charset="utf-8"></script>
    <style media="screen">
      h5 {
        margin-bottom: -1em;
      }
    </style>
    <script>
      let settings = require('electron-settings');
    </script>
  </head>
  <body style="padding-left: 8px; padding-right: 8px;">
    <header><h3 style="width: 100%;">Settings <button style="float: right">Done</button></h3></header>
    <section>
      <h4>Keyboard Shortcuts</h4>
      <h5>Open/close from any app</h5>
      <p>
        <label>
          <input type="checkbox" name="gbl.toggle.ctrl" disabled>
          <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>U</kbd>
        </label><br>
        <label>
          <input type="checkbox" name="gbl.toggle.cmd" disabled>
          <kbd>Shift</kbd>+<kbd>⌘</kbd>+<kbd>U</kbd>
        </label>
      </p>
      <h5>Search results</h5>
      <p>
        <label><kbd>↑</kbd>: Highlight Previous</label><br>
        <label><kbd>↓</kbd>: Highlight Next</label><br>
        <label><kbd>&#9166; Enter</kbd>: Copy selected</label>
      </p>
    </section>
    <script>
      function recursivelyApply(vals, f, _prefix) {
        Object.keys(vals).forEach(name => {
          let newName = (_prefix ? _prefix+'.':"") + name;
          if (typeof vals[name] === "object") {
            recursivelyApply(vals[name], f, newName);
          } else {
            f(newName, vals[name]);
          }
        });
      }
      settings.get().then(vals => {
        recursivelyApply(vals, (key, value) => {
          $(`[name="${key}"]`).removeAttr('disabled').prop('checked', value);
        });
      });
      $('button').click(() => {
        window.parent.$('.settings').removeClass('active');
      });
      $('input').on('change', ({target: {name, checked}}) => {
        settings.setSync(name, checked);
      });
    </script>
  </body>
</html>
